<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Definir Hábito</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6fa;
      min-height: 100vh;
      padding: 2rem;
    }
    main {
      max-width: 400px;
      margin: 0 auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      padding: 2rem;
    }
    h2 {
      color: #2d3748;
      text-align: center;
    }
    #confirmation-msg {
      color: green;
      margin-top: 1rem;
      text-align: center;
    }
    #undo-btn {
      display: none;
      margin-top: 1rem;
      width: 100%;
    }
  </style>
</head>
<body>
  <main>
    <h2>Definir un nuevo hábito</h2>
    <form id="habit-form">
      <input type="text" id="habit-input" placeholder="Describe tu hábito" required style="width:100%;padding:0.5rem;margin-bottom:1rem;">
      <button type="submit" style="width:100%;">Guardar hábito</button>
    </form>
    <div id="confirmation-msg"></div>
    <button id="undo-btn">Deshacer último hábito</button>
    <ul id="habit-list" style="margin-top:2rem;"></ul>
  </main>
  <script>
    function getHabits() {
      return JSON.parse(localStorage.getItem('habits') || '[]');
    }
    function setHabits(habits) {
      localStorage.setItem('habits', JSON.stringify(habits));
    }
    const form = document.getElementById('habit-form');
    const input = document.getElementById('habit-input');
    const msg = document.getElementById('confirmation-msg');
    const undoBtn = document.getElementById('undo-btn');
    const list = document.getElementById('habit-list');
    let lastHabit = null;
    function renderHabits() {
      const habits = getHabits();
      list.innerHTML = '';
      habits.forEach(h => {
        const li = document.createElement('li');
        li.textContent = h;
        list.appendChild(li);
      });
    }
    form.onsubmit = (e) => {
      e.preventDefault();
      const habit = input.value.trim();
      if (!habit) return;
      const habits = getHabits();
      habits.push(habit);
      setHabits(habits);
      lastHabit = habit;
      renderHabits();
      msg.textContent = '¡Hábito guardado!';
      undoBtn.style.display = '';
      input.value = '';
    };
    undoBtn.onclick = () => {
      let habits = getHabits();
      if (lastHabit && habits.length && habits[habits.length-1] === lastHabit) {
        habits.pop();
        setHabits(habits);
        renderHabits();
        msg.textContent = 'Último hábito eliminado.';
        undoBtn.style.display = 'none';
        lastHabit = null;
      }
    };
    renderHabits();
    if (getHabits().length) undoBtn.style.display = '';
  </script>
</body>
</html>
